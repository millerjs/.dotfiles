# General options
set-option -g default-command "if uname -arv | grep -i darwin >/dev/null; then reattach-to-user-namespace -l bash; else bash; fi"
set -g history-limit 10000
setw -g xterm-keys on

# Aesthetics
set-option -g default-terminal "xterm-256color"
set-window-option -g utf8 on
set-option -g status-bg colour235 #base02
set-option -g status-fg yellow #yellow
set-option -g status-attr dim
set-option -g pane-border-fg colour235        #base02
set-option -g pane-active-border-fg colour21 #base01
set-option -g status on                       # turn the status bar on
set -g status-utf8 on                         # set utf-8 for the status bar
set -g status-left-length 300
set -g status-left "#[fg=green]: #h : #[fg=brightblue]#(ifconfig | grep 'inet' | grep -v 'inet6' | grep -v 127.0.0.1 | head -n1 | awk '{print $2}') #[fg=red]#(ifconfig tun0 | grep 'inet ' | awk '{print \"vpn \" $2}') : #[fg=green] [#{pane_width}x#{pane_height}] "
set -g status-right-length 300
set -g status-right "#{?pane_synchronized, ❮❮ SYNC ❯❯ ,} #{?client_prefix,★ ,  } #[fg=brightblue]#S #I:#P #[fg=yellow]:: %d %b %Y #[fg=green]:: %l:%M %p "
set -g status-right "#[fg=colour240]⦅ #(tmux list-sessions -F '#S' | tr '\n' ' ' | sed -e 's/[[:space:]]*$//' | sed 's/ / | /g' | sed \"s/`tmux display-message -p '#S'`/#[fg=brightblue]`tmux display-message -p '#S'`#[fg=colour240]/g\") ⦆ #{?pane_synchronized,#[bg=magenta]#[fg=yellow] ❮❮ SYNC ❯❯ #[bg=colour235],}#[fg=brightgreen] #{?client_prefix,★ ,  }  #[fg=brightblue]#I:#P #[fg=yellow]:: %d %b %Y #[fg=green]:: %l:%M %p "
set -g status-interval 5
set-option repeat-time 0

setw -g aggressive-resize off
# bind to reload config
set-option -g prefix C-o
bind r source-file ~/.tmux.conf \; display "Reloaded config file"

bind 1 \
     split-window -h -p 44\;\
     resize-pane -t 0 -x 85\;\
     split-window -v -p 65\;\
     split-window -v -p 43\;\
     rotate-window -D \;\
     select-pane -U

bind 2 \
     split-window -h -p 63\;\
     resize-pane -t 0 -x 90\;\
     split-window -h -p 63\;\
     resize-pane -t 0 -x 90\;\
     split-window -v -p 50\;\
     rotate-window -D \;\
     select-pane -U


bind C-a set -g synchronize-panes

# Split pane movement
bind C-b select-pane -L
bind C-f select-pane -R
bind C-p select-pane -U
bind C-n select-pane -D

bind b select-pane -L
bind f select-pane -R
bind p select-pane -U
bind n select-pane -D

unbind C-o
bind C-r rotate-window -D
bind M-r rotate-window -U

# Session switching
bind w list-sessions
bind s command-prompt -p "session:" "switch-client -t %1"\; refresh-client -S
bind C-l switch-client -l\; refresh-client -S
bind j switch-client -p\; refresh-client -S
bind l switch-client -n\; refresh-client -S

# Pane resizing
bind -n M-C-Down resize-pane -D 5
bind -n M-C-Up resize-pane -U 5
bind -n M-C-Left resize-pane -L 5
bind -n M-C-Right resize-pane -R 5

bind M-Down resize-pane -D 5
bind M-Up resize-pane -U 5
bind M-Left resize-pane -L 5
bind M-Right resize-pane -R 5

# Split pane splitting
bind v split-window -h
bind h split-window -v
bind C-v split-window -h
bind C-h split-window -v

# disable mouse control by default - change 'off' to 'on' to enable by default.
setw -g mode-mouse off
set-option -g mouse-resize-pane off
set-option -g mouse-select-pane off
set-option -g mouse-select-window off
# toggle mouse mode to allow mouse copy/paste
# set mouse on with prefix m
bind m \
    set -g mode-mouse on \;\
    set -g mouse-resize-pane on \;\
    set -g mouse-select-pane on \;\
    set -g mouse-select-window on \;\
    display 'Mouse: ON'
# set mouse off with prefix M
bind M \
    set -g mode-mouse off \;\
    set -g mouse-resize-pane off \;\
    set -g mouse-select-pane off \;\
    set -g mouse-select-window off \;\
    display 'Mouse: OFF'
# zoom this pane to full screen
unbind +
unbind -
bind + \
    new-window -d -n tmux-zoom 'clear && echo TMUX ZOOM && read' \;\
    swap-pane -s tmux-zoom.0 \;\
    select-window -t tmux-zoom
# restore this pane
bind - \
    last-window \;\
    swap-pane -s tmux-zoom.0 \;\
    kill-window -t tmux-zoom

# ======== Plugins ========
set -g @plugin 'tmux-plugins/tpm'

# run plugin manager
run '~/.tmux/plugins/tpm/tpm'
